<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>Feel Outside The Box</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width">
        <link rel="stylesheet" type="text/css" href="css/site.css" />
        <script type="text/javascript" src="js/enchant/enchant.js"></script>
        <script type="text/javascript" src="js/jquery/jquery-1.11.0.js"></script>
    </head>
    <body>
        <div id="header"><h1>Feel Outside The Box</h1></div>
        <hr />
        <div id="content">
            <div id="enchant-stage"></div>
        </div>
        <hr />
        <div id="footer">
            <ul>
                <li>
                    <span class="credits_title">Credits:</span>
                    <ul>
                        <li>Coded by <span class="credit">Katariina Pohjola</span> and <span class="credit">Mikko Sairo</span></li>
                        <li>Graphics by <span class="credit">Muura Parkkinen</span> and <span class="credit">Mira INSERTNAMEHERE</span></li>
                        <li>Audio by <span class="credit">Tapani INSERTNAMEHERE</span> and <span class="credit">INSERTNAMEHERE INSERTNAMEHERE</span></li>
                    </ul>
                </li>
            </ul>
        </div>
        <script type="text/javascript">
            var gamediv = $('#enchant-stage');
            window.onload = function() {
                enchant();
                
                var game = new Game(1024,600);
                game.preload('img/test_world.png', 'img/world_5000x5000.gif', 'img/kissa.png', 'img/tipu_1000x732.gif', 'img/tipu.gif');
                game.onload = function() {
                    game.scale = 1;
                    game.fps = 20;
                    game.scenes = new Object();
                    
                    var startScene = new StartScene();
                    game.scenes.start = startScene;
                    
                    game.pushScene(game.scenes.start);
                };
                
                game.start();
                
                var StartScene = Class.create(Scene, {
                    game: Game.instance,
                    initialize: function() {
                        Scene.apply(this);
                        
                        this.backgroundColor = '#aaaaaa';

                        this.title = new Label("Feel Outside The Box");
                        this.title.font = '32px Comic Sans MS';
                        this.title.width = 330;
                        this.title.x = gamediv.width() / 2 - this.title.width / 2;
                        this.title.y = 50;
                        this.addChild(this.title);
                        
                        this.subtitle = new TitleLabel("FGJ2014 - Pohjois-Karjala");
                        this.subtitle.width = 400;
                        this.subtitle.x = gamediv.width() / 2 - this.subtitle.width / 2;
                        this.subtitle.y = 150;
                        this.addChild(this.subtitle);
                        
                        this.char = new Character(781,602);
                        this.addChild(this.char);
                        
                        this.world = new World(1000, 1000, 'img/test_world.png');
                        this.addChild(this.world);
                        
                        this.addEventListener(Event.TOUCH_START, this.onTouchStart);
                        this.addEventListener(Event.ENTER_FRAME, this.onEnterFrame);
                    },

                    onTouchStart: function(e) {
                        var gameScene = new GameScene();
                        game.scenes.game = gameScene;
                    
                        game.replaceScene(game.scenes.game);
                    },
                    onEnterFrame: function(e) {
                        //this.char.onEnterFrame(e);
                        this.world.rotate(-0.1);
                    }
                });
                
                var GameScene = Class.create(Scene, {
                    game: Game.instance,
                    initialize: function() {
                        Scene.apply(this);
                        
                        this.world = new World(1000, 1000, 'img/test_world.png');
                        this.addChild(this.world);
                        
                        this.backgroundColor = '#dddddd';

                        this.title = new Label("Feel Outside The Box");
                        this.title.font = '32px Comic Sans MS';
                        this.title.width = 330;
                        this.title.x = gamediv.width() / 2 - this.title.width / 2;
                        this.title.y = 50;
                        this.addChild(this.title);
                        
                        this.char = new Character(781,602);
                        this.addChild(this.char);
                        
                        this.clock = new Clock();
                        this.addChild(this.clock);
                        
                        this.addEventListener(Event.TOUCH_START, this.onTouchStart);
                        this.addEventListener(Event.ENTER_FRAME, this.onEnterFrame);
                    },
                    onTouchStart: function(e) {
                        game.replaceScene(game.scenes.start);
                    },
                    onEnterFrame: function(e) {
                        this.world.rotate(-0.1);
                        this.clock.onEnterFrame(e);
                    }
                });
                
                var World = Class.create(Sprite, {
                   game: Game.instance,
                   initialize: function(width, height, image) {
                        Sprite.apply(this, [width, height]);
                        if(typeof image === 'string') {
                            this.image = game.assets[image];
                        } else if(typeof image === 'object') {
                            this.image = image;
                        }
                        
                        this.scaleX = 5;
                        this.scaleY = 5;
                        this.x = gamediv.width() / 2 - this.width / 2;
                        this.y = 2450;
                   }
                });
                
                var Character = Class.create(Sprite, {
                    game: Game.instance,
                    initialize: function(width, height, image) {
                        Sprite.apply(this, [width, height]);
                        if(typeof image === 'string') {
                            this.image = game.assets[image];
                        } else if(typeof image === 'object') {
                            this.image = image;
                        } else {
                            this.image = game.assets['img/tipu_1000x732.gif'];
                            this.frame = [0,1,2,3,4,5,6,9,10,11];
                        }
                        
                        this.scaleX = 0.15;
                        this.scaleY = 0.15;
                        this.x = gamediv.width() / 2 - this.width / 2;
                        this.y = 115;
                    },
                    
                    onEnterFrame: function(e) {
                        //this.rotate(1);
                    }
                });
                
                var TitleLabel = Class.create(Label, {
                    game: Game.instance,
                    initialize: function(text) {
                        Label.apply(this, [text]);
                        //this.text = text;
                        this.font = '32px Comic Sans MS';
                        this.width = 330;
                    }
                });
                
                var Clock = Class.create(Label, {
                    game: Game.instance,
                    initialize: function() {
                        Label.apply(this, ['00:00']);
                        
                        this.hours = 8;
                        this.minutes = 0;
                        this.time = 0;
                        
                        this.font = "32px Comic Sans MS";
                        
                        this.updateClock();
                    },
                    updateClock: function() {
                        var hourText = this.hours > 9 ? this.hours : "0" + this.hours;
                        var minText = this.minutes > 9 ? this.minutes : "0" + this.minutes;
                        
                        this.text = hourText + ":" + minText;
                    },
                    onEnterFrame: function(e) {
                        this.time += e.elapsed * 0.001;
                        if(this.time >= 5) {
                            this.minutes = (this.minutes + 15) % 60;
                            if(this.minutes === 0) {
                                this.hours = (this.hours + 1) % 60;
                            }
                            this.time -= 5;
                            this.updateClock();
                        }
                    }
                });
            };
        </script>
    </body>
</html>
